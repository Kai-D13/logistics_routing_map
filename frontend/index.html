<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Logistics Routing System - Qu·∫£n l√Ω Tuy·∫øn ƒê∆∞·ªùng</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css?v=4">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1>üöö Logistics Routing System</h1>
            <p>H·ªá th·ªëng qu·∫£n l√Ω tuy·∫øn ƒë∆∞·ªùng v·∫≠n chuy·ªÉn</p>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Control Panel -->
        <div class="control-panel">
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-icon">üè†</div>
                    <div class="stat-info">
                        <h3 id="departer-count">0</h3>
                        <p>Hub Ch√≠nh</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìç</div>
                    <div class="stat-info">
                        <h3 id="destination-count">0</h3>
                        <p>ƒêi·ªÉm Giao H√†ng</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üöö</div>
                    <div class="stat-info">
                        <h3 id="trip-count">0</h3>
                        <p>Chuy·∫øn ƒêi</p>
                    </div>
                </div>
            </div>

            <!-- Feature Tabs -->
            <div class="feature-tabs">
                <button class="tab-btn active" data-tab="map">üó∫Ô∏è B·∫£n ƒê·ªì</button>
                <button class="tab-btn" data-tab="routes">üìã Qu·∫£n L√Ω Routes</button>
                <button class="tab-btn" data-tab="vrp">üöÄ T·ªëi ∆Øu VRP</button>
            </div>

            <!-- Tab Contents -->
            <div class="tab-content active" id="map-tab">
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="openAddDeparterModal()">
                        <span>‚ûï</span> Th√™m Hub Ch√≠nh
                    </button>
                    <button class="btn btn-success" onclick="openAddDestinationModal()">
                        <span>‚ûï</span> Th√™m ƒêi·ªÉm Giao H√†ng
                    </button>
                    <button class="btn btn-warning" onclick="openCalculateDistanceModal()">
                        <span>üìè</span> T√≠nh Kho·∫£ng C√°ch
                    </button>
                    <button class="btn btn-info" onclick="refreshMap()">
                        <span>üîÑ</span> L√†m M·ªõi
                    </button>
                </div>
            </div>

            <div class="tab-content" id="routes-tab">
                <div class="routes-panel">
                    <!-- Header -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">üîç Qu·∫£n L√Ω Routes</h3>
                        <button class="btn btn-primary" onclick="openCreateRouteModal()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; padding: 10px 20px; font-weight: 600;">
                            ‚ûï T·∫°o Route M·ªõi
                        </button>
                    </div>

                    <!-- Search Filters - Simplified -->
                    <div class="search-filters" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="route-select">Ch·ªçn Route:</label>
                                    <select id="route-select" class="form-control" style="font-size: 16px; padding: 10px;">
                                        <option value="">-- Ch·ªçn Route --</option>
                                    </select>
                                    <small class="form-text text-muted">Ch·ªçn route ƒë·ªÉ xem chi ti·∫øt v√† hi·ªÉn th·ªã tr√™n b·∫£n ƒë·ªì</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Route Details Container -->
                    <div id="route-details-container"></div>
                </div>
            </div>

            <div class="tab-content" id="vrp-tab">
                <div class="vrp-panel">
                    <h3>üöÄ T·ªëi ∆Øu Tuy·∫øn ƒê∆∞·ªùng (VRP)</h3>

                    <div class="form-group">
                        <label for="vrp-departer-select">ƒêi·ªÉm Xu·∫•t Ph√°t:</label>
                        <select id="vrp-departer-select" class="form-control">
                            <option value="">-- Ch·ªçn ƒëi·ªÉm xu·∫•t ph√°t --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Ch·ªçn ƒêi·ªÉm ƒê·∫øn:</label>
                        <div class="destinations-actions">
                            <button id="select-all-destinations" class="btn btn-sm">Ch·ªçn t·∫•t c·∫£</button>
                            <button id="deselect-all-destinations" class="btn btn-sm">B·ªè ch·ªçn</button>
                        </div>
                        <div id="vrp-destinations-list" class="destinations-list"></div>
                    </div>

                    <div class="vrp-actions">
                        <button id="optimize-route-btn" class="btn btn-primary">
                            üöÄ T·ªëi ∆Øu Tuy·∫øn ƒê∆∞·ªùng
                        </button>
                        <button id="clear-vrp-btn" class="btn btn-secondary">
                            üóëÔ∏è X√≥a
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Container -->
        <div class="map-container">
            <div id="map"></div>
        </div>

        <!-- Locations List -->
        <div class="locations-panel">
            <h2>üìã Danh S√°ch ƒêi·ªÉm Giao H√†ng</h2>
            <div class="search-box">
                <input type="text" id="search-input" placeholder="üîç T√¨m ki·∫øm theo t√™n, t·ªânh..." onkeyup="filterLocations()">
            </div>
            <div id="locations-list" class="locations-list">
                <!-- Locations will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Modal: Add Departer -->
    <div id="departerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï Th√™m Hub Ch√≠nh</h2>
                <span class="close" onclick="closeDeparterModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="departerForm" onsubmit="submitDeparter(event)">
                    <div class="form-group">
                        <label for="departer-name">T√™n Hub *</label>
                        <input type="text" id="departer-name" required placeholder="VD: Hub Ch√≠nh H√† N·ªôi">
                    </div>
                    <div class="form-group">
                        <label for="departer-address">ƒê·ªãa Ch·ªâ *</label>
                        <input type="text" id="departer-address" required placeholder="VD: 123 ƒê∆∞·ªùng ABC, Qu·∫≠n XYZ">
                        <small>ƒê·ªãa ch·ªâ s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông geocode ƒë·ªÉ l·∫•y t·ªça ƒë·ªô</small>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeDeparterModal()">H·ªßy</button>
                        <button type="submit" class="btn btn-primary">Th√™m Hub</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Add Destination -->
    <div id="destinationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï Th√™m ƒêi·ªÉm Giao H√†ng</h2>
                <span class="close" onclick="closeDestinationModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="destinationForm" onsubmit="submitDestination(event)">
                    <div class="form-group">
                        <label for="destination-carrier">T√™n Carrier *</label>
                        <input type="text" id="destination-carrier" required placeholder="VD: NVCT Hub H√† N·ªôi">
                    </div>
                    <div class="form-group">
                        <label for="destination-address">ƒê·ªãa Ch·ªâ *</label>
                        <input type="text" id="destination-address" required placeholder="VD: 456 ƒê∆∞·ªùng DEF">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="destination-ward">Ph∆∞·ªùng/X√£</label>
                            <input type="text" id="destination-ward" placeholder="VD: Ph∆∞·ªùng 1">
                        </div>
                        <div class="form-group">
                            <label for="destination-district">Qu·∫≠n/Huy·ªán</label>
                            <input type="text" id="destination-district" placeholder="VD: Qu·∫≠n 1">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="destination-province">T·ªânh/Th√†nh Ph·ªë *</label>
                        <input type="text" id="destination-province" required placeholder="VD: Th√†nh ph·ªë H√† N·ªôi">
                    </div>
                    <div class="form-group">
                        <label for="destination-departer">Hub Ch√≠nh *</label>
                        <select id="destination-departer" required>
                            <option value="">-- Ch·ªçn Hub Ch√≠nh --</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeDestinationModal()">H·ªßy</button>
                        <button type="submit" class="btn btn-success">Th√™m ƒêi·ªÉm Giao H√†ng</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Location Details -->
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="details-title">üìç Chi Ti·∫øt</h2>
                <span class="close" onclick="closeDetailsModal()">&times;</span>
            </div>
            <div class="modal-body" id="details-body">
                <!-- Details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Modal: Calculate Distance (Multi-Destination) -->
    <div id="calculateDistanceModal" class="modal">
        <div class="modal-content" style="max-width: 1100px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2>üìè T√≠nh Kho·∫£ng C√°ch</h2>
                <span class="close" onclick="closeCalculateDistanceModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="calculateDistanceForm" onsubmit="submitCalculateDistance(event)">
                    <!-- Optional: Hub Ch√≠nh -->
                    <div class="form-group">
                        <label for="calc-departer-select">ƒêi·ªÉm Xu·∫•t Ph√°t (Hub Ch√≠nh) - T√πy ch·ªçn</label>
                        <select id="calc-departer-select" class="form-control">
                            <option value="">-- Kh√¥ng ch·ªçn (t·ª± ƒë·ªông) --</option>
                        </select>
                        <small style="color: #64748b;">N·∫øu kh√¥ng ch·ªçn, h·ªá th·ªëng s·∫Ω t√≠nh t·ª´ ƒëi·ªÉm ƒë·∫ßu ti√™n b·∫°n ch·ªçn b√™n d∆∞·ªõi</small>
                    </div>

                    <div class="form-group">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="margin: 0;">Ch·ªçn ƒêi·ªÉm ƒê·∫øn *</label>
                            <span id="calc-selected-count" style="background: #667eea; color: white; padding: 4px 12px; border-radius: 20px; font-size: 13px; font-weight: 600;">
                                ƒê√£ ch·ªçn: 0/20
                            </span>
                        </div>
                        <small style="color: #64748b; margin-bottom: 10px; display: block;">Ch·ªçn √≠t nh·∫•t 1 ƒëi·ªÉm (ho·∫∑c 2 ƒëi·ªÉm n·∫øu kh√¥ng ch·ªçn Hub Ch√≠nh)</small>

                        <!-- Search Box -->
                        <div style="margin-bottom: 10px;">
                            <input
                                type="text"
                                id="calc-search-destinations"
                                class="form-control"
                                placeholder="üîç T√¨m ki·∫øm ƒëi·ªÉm ƒë·∫øn..."
                                style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; width: 100%;"
                            >
                        </div>

                        <!-- Action Buttons -->
                        <div class="destinations-actions" style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <button type="button" id="calc-select-all" class="btn btn-sm" style="flex: 1; background: #10b981; color: white; border: none; padding: 8px; border-radius: 6px; font-weight: 500;">
                                ‚úì Ch·ªçn t·∫•t c·∫£
                            </button>
                            <button type="button" id="calc-deselect-all" class="btn btn-sm" style="flex: 1; background: #ef4444; color: white; border: none; padding: 8px; border-radius: 6px; font-weight: 500;">
                                ‚úó B·ªè ch·ªçn
                            </button>
                        </div>

                        <!-- Destinations List -->
                        <div id="calc-destinations-list" class="destinations-list" style="max-height: 400px; overflow-y: auto; border: 2px solid #e2e8f0; border-radius: 8px; padding: 12px; background: #f9fafb;">
                            <!-- Destinations will be loaded here -->
                        </div>
                        <small style="color: #64748b;">Ch·ªçn √≠t nh·∫•t 1 ƒëi·ªÉm ƒë·∫øn (t·ªëi ƒëa 20 ƒëi·ªÉm)</small>
                    </div>

                    <div class="form-group">
                        <label for="calc-vehicle-type">Ph∆∞∆°ng Ti·ªán</label>
                        <select id="calc-vehicle-type" class="form-control">
                            <option value="truck" selected>üöö Xe T·∫£i (Truck)</option>
                            <option value="car">üöó Xe H∆°i (Car)</option>
                            <option value="bike">üèçÔ∏è Xe M√°y (Bike)</option>
                        </select>
                    </div>

                    <!-- Result Display -->
                    <div id="calc-distance-result" class="distance-result" style="display: none; margin-top: 20px;">
                        <h3 style="color: #667eea; margin-bottom: 15px; font-size: 18px; font-weight: 600;">üìä K·∫øt Qu·∫£ T√≠nh To√°n</h3>
                        <div class="result-summary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                                <div style="text-align: center;">
                                    <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: 13px; font-weight: 500;">T·ªïng Kho·∫£ng C√°ch</p>
                                    <p style="margin: 8px 0 0 0; color: white; font-size: 28px; font-weight: 700;" id="calc-total-distance">-</p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: 13px; font-weight: 500;">T·ªïng Th·ªùi Gian</p>
                                    <p style="margin: 8px 0 0 0; color: white; font-size: 28px; font-weight: 700;" id="calc-total-duration">-</p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: 13px; font-weight: 500;">S·ªë ƒêi·ªÉm ƒê·∫øn</p>
                                    <p style="margin: 8px 0 0 0; color: white; font-size: 28px; font-weight: 700;" id="calc-total-stops">-</p>
                                </div>
                            </div>
                        </div>
                        <div id="calc-route-details" style="max-height: 500px; overflow-y: auto; border: 2px solid #e2e8f0; border-radius: 8px; padding: 15px; background: white;">
                            <!-- Route details will be displayed here -->
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeCalculateDistanceModal()">ƒê√≥ng</button>
                        <button type="submit" class="btn btn-warning">üîç T√≠nh To√°n</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Create Route -->
    <div id="createRouteModal" class="modal">
        <div class="modal-content" style="max-width: 1100px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2>‚ûï T·∫°o Route M·ªõi</h2>
                <span class="close" onclick="closeCreateRouteModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createRouteForm" onsubmit="submitCreateRoute(event)">
                    <!-- Route Name -->
                    <div class="form-group">
                        <label for="new-route-name">T√™n Route *</label>
                        <input
                            type="text"
                            id="new-route-name"
                            class="form-control"
                            placeholder="V√≠ d·ª•: C·∫ßn Th∆° - Vƒ©nh Long - Ti·ªÅn Giang R2"
                            required
                        >
                        <small style="color: #64748b;">ƒê·∫∑t t√™n theo format: Hub Ch√≠nh - Hub 1 - Hub 2 - ... RX</small>
                    </div>

                    <!-- Hub Ch√≠nh (Origin) -->
                    <div class="form-group">
                        <label for="new-route-hub">Hub Ch√≠nh (ƒêi·ªÉm Xu·∫•t Ph√°t) *</label>
                        <select id="new-route-hub" class="form-control" required>
                            <option value="">-- Ch·ªçn Hub Ch√≠nh --</option>
                        </select>
                        <small style="color: #64748b;">Hub ch√≠nh s·∫Ω l√† ƒëi·ªÉm xu·∫•t ph√°t c·ªßa route</small>
                    </div>

                    <!-- Destinations -->
                    <div class="form-group">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="margin: 0;">Ch·ªçn ƒêi·ªÉm ƒê·∫øn (Destinations) *</label>
                            <span id="new-route-selected-count" style="background: #667eea; color: white; padding: 4px 12px; border-radius: 20px; font-size: 13px; font-weight: 600;">
                                ƒê√£ ch·ªçn: 0
                            </span>
                        </div>

                        <!-- Search Box -->
                        <div style="margin-bottom: 10px;">
                            <input
                                type="text"
                                id="new-route-search-destinations"
                                class="form-control"
                                placeholder="üîç T√¨m ki·∫øm ƒëi·ªÉm ƒë·∫øn..."
                                style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; width: 100%;"
                            >
                        </div>

                        <!-- Destinations List -->
                        <div id="new-route-destinations-list" class="destinations-list" style="max-height: 300px; overflow-y: auto; border: 2px solid #e2e8f0; border-radius: 8px; padding: 12px; background: #f9fafb;">
                            <!-- Destinations will be loaded here -->
                        </div>
                        <small style="color: #64748b;">Ch·ªçn √≠t nh·∫•t 1 ƒëi·ªÉm ƒë·∫øn</small>
                    </div>

                    <!-- Selected Destinations Order (Drag & Drop) -->
                    <div class="form-group" id="new-route-order-section" style="display: none;">
                        <label>Th·ª© T·ª± ƒêi·ªÉm ƒê·∫øn (K√©o th·∫£ ƒë·ªÉ s·∫Øp x·∫øp)</label>
                        <div id="new-route-order-list" class="route-order-list" style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 12px; background: white; min-height: 100px;">
                            <!-- Selected destinations will appear here for ordering -->
                        </div>
                        <small style="color: #64748b;">K√©o th·∫£ ƒë·ªÉ thay ƒë·ªïi th·ª© t·ª± ƒëi·ªÉm ƒë·∫øn</small>
                    </div>

                    <!-- Vehicle Type -->
                    <div class="form-group">
                        <label for="new-route-vehicle">Ph∆∞∆°ng Ti·ªán</label>
                        <select id="new-route-vehicle" class="form-control">
                            <option value="truck" selected>üöö Xe T·∫£i (Truck)</option>
                            <option value="car">üöó Xe H∆°i (Car)</option>
                            <option value="bike">üèçÔ∏è Xe M√°y (Bike)</option>
                        </select>
                    </div>

                    <!-- Before/After Comparison (Edit Mode Only) -->
                    <div id="route-comparison" class="route-comparison" style="display: none; margin-top: 20px;">
                        <h3 style="color: #667eea; margin-bottom: 15px; font-size: 18px; font-weight: 600;">üìä So S√°nh Thay ƒê·ªïi</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <!-- Before -->
                            <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 15px; background: #fef2f2;">
                                <h4 style="color: #ef4444; margin-bottom: 10px;">‚ùå Tr∆∞·ªõc Khi S·ª≠a</h4>
                                <div id="comparison-before-metrics" style="font-size: 14px; color: #64748b;">
                                    <!-- Original metrics -->
                                </div>
                            </div>
                            <!-- After -->
                            <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 15px; background: #f0fdf4;">
                                <h4 style="color: #10b981; margin-bottom: 10px;">‚úÖ Sau Khi S·ª≠a</h4>
                                <div id="comparison-after-metrics" style="font-size: 14px; color: #64748b;">
                                    <!-- New metrics -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Preview Section -->
                    <div id="new-route-preview" class="route-preview" style="display: none; margin-top: 20px;">
                        <h3 style="color: #667eea; margin-bottom: 15px; font-size: 18px; font-weight: 600;">üìä Preview Route</h3>
                        <div class="result-summary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                                <div style="text-align: center;">
                                    <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: 13px; font-weight: 500;">T·ªïng Kho·∫£ng C√°ch</p>
                                    <p style="margin: 8px 0 0 0; color: white; font-size: 28px; font-weight: 700;" id="new-route-total-distance">-</p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: 13px; font-weight: 500;">T·ªïng Th·ªùi Gian</p>
                                    <p style="margin: 8px 0 0 0; color: white; font-size: 28px; font-weight: 700;" id="new-route-total-duration">-</p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: 13px; font-weight: 500;">S·ªë ƒêi·ªÉm ƒê·∫øn</p>
                                    <p style="margin: 8px 0 0 0; color: white; font-size: 28px; font-weight: 700;" id="new-route-total-stops">-</p>
                                </div>
                            </div>
                        </div>
                        <div id="new-route-details" style="max-height: 400px; overflow-y: auto; border: 2px solid #e2e8f0; border-radius: 8px; padding: 15px; background: white;">
                            <!-- Route details will be displayed here -->
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px;">
                        <button type="button" class="btn btn-secondary" onclick="closeCreateRouteModal()">ƒê√≥ng</button>
                        <button type="button" class="btn btn-warning" onclick="previewNewRoute()" style="flex: 1;">
                            üëÅÔ∏è Preview Route
                        </button>
                        <button type="button" class="btn btn-success" onclick="exportNewRoute()" id="export-new-route-btn" style="display: none;">
                            üíæ Export JSON
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>ƒêang x·ª≠ l√Ω...</p>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Route Details Panel -->
    <div id="route-details-panel" class="side-panel">
        <div class="side-panel-header">
            <h3>üìã Chi Ti·∫øt Route</h3>
            <button id="close-route-details" class="close-btn">&times;</button>
        </div>
        <div class="side-panel-content">
            <div id="trip-info" class="trip-info"></div>

            <!-- Edit Route Button -->
            <button
                id="edit-route-btn"
                class="btn btn-primary"
                onclick="openEditRouteModal()"
                style="width: 100%; margin: 15px 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; padding: 12px; font-weight: 600;">
                ‚úèÔ∏è Ch·ªânh S·ª≠a Route
            </button>

            <h4 style="margin-top: 20px; margin-bottom: 10px;">üìç Timeline Giao H√†ng</h4>
            <div id="destinations-timeline"></div>
        </div>
    </div>

    <!-- VRP Result Panel -->
    <div id="vrp-result-panel" class="side-panel">
        <div class="side-panel-header">
            <h3>üöÄ K·∫øt Qu·∫£ T·ªëi ∆Øu</h3>
            <button id="close-vrp-result" class="close-btn">&times;</button>
        </div>
        <div class="side-panel-content">
            <div id="vrp-route-info"></div>
            <h4 style="margin-top: 20px; margin-bottom: 10px;">üìç L·ªô Tr√¨nh</h4>
            <div id="vrp-route-steps"></div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Leaflet Polyline Encoded -->
    <script src="https://unpkg.com/polyline-encoded@0.0.9/Polyline.encoded.js"></script>

    <!-- Leaflet Polyline Decorator (for arrows) -->
    <script src="https://unpkg.com/leaflet-polylinedecorator@1.6.0/dist/leaflet.polylineDecorator.js"></script>

    <!-- Custom JS -->
    <script src="js/api.js?v=4"></script>
    <script src="js/hub-editor.js?v=4"></script>
    <script src="js/map.js?v=4"></script>
    <script src="js/ui.js?v=4"></script>
    <script src="js/routes.js?v=4"></script>
    <script src="js/route-builder.js?v=4"></script>
    <script src="js/route-management.js?v=4"></script>
    <script src="js/vrp.js?v=4"></script>
    <script src="js/app.js?v=4"></script>
</body>
</html>

